#Layout template

checkout:
  step_name: "checkout"
  command: "git clone https://github.com/blaqguy/in-toto-demo.git"
  product_rules:
    - "CREATE *.py"
    - "CREATE *.pub"
    - "CREATE *.md"
    - "CREATE root.layout"
    - "DISALLOW *"

lint:
  step_name: lint
  command: find . -type f -name "*.py" | xargs pylint --exit-zero
  material_rules: 
    - "MATCH * WITH PRODUCTS FROM checkout"

unit-test:
  step_name: unit-test
  command: python3 test.py -v
  material_rules: 
    - "MATCH * WITH PRODUCTS FROM checkout"
  product_rules:
    - "CREATE __pycache__"

package:
  step_name: package
  command: tar cfvz helloworld.tar *
  material_rules: 
    - "MATCH * WITH PRODUCTS FROM unit-test"  
  product_rules: 
    - "CREATE helloworld.tar"

inspect:
  name: inspect
  command: tar xzf helloworld.tar
  material_rules: 
    - "MATCH * WITH PRODUCTS FROM package"
    - "DISALLOW *"
  product_rules: 
    - "MATCH * WITH PRODUCTS FROM package"
    - "DISALLOW *"